# ì›”ë³„ íˆ¬ì ë¹„êµ í˜ì´ì§€ UI ë””ìì¸

## 1. í˜ì´ì§€ ê°œìš”

**ëª©ì **: ì´ë²ˆ ë‹¬ê³¼ ì €ë²ˆ ë‹¬ì˜ íˆ¬ì ì„±ê³¼ë¥¼ ë¹„êµí•˜ì—¬ ìì‚° ë³€ë™ ë‚´ì—­ì„ ì‹œê°í™”

**ì£¼ìš” ê¸°ëŠ¥**:
- ì´ ìì‚°, ì›ê¸ˆ, ìˆ˜ìµê¸ˆ, ìˆ˜ìµë¥  í•œëˆˆì— ë³´ê¸°
- ì „ì›” ëŒ€ë¹„ ì¦ê° í‘œì‹œ
- ìì‚° ë³€ë™ ì›Œí„°í´ ì°¨íŠ¸
- ì›”ë³„ íˆìŠ¤í† ë¦¬ í…Œì´ë¸”

## 2. ë ˆì´ì•„ì›ƒ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“… ì›”ë³„ íˆ¬ì ë¹„êµ - 2025-12                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ ğŸ’° ì´ìì‚° â”‚  â”‚ ğŸ’µ ì´ì›ê¸ˆ â”‚  â”‚ ğŸ“ˆ ì´ìˆ˜ìµ â”‚  â”‚ ğŸ“Š ìˆ˜ìµë¥  â”‚      â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚      â”‚
â”‚  â”‚ 1,469,982â”‚  â”‚ 1,400,000â”‚  â”‚  +69,982 â”‚  â”‚  +5.0%   â”‚      â”‚
â”‚  â”‚   ì›     â”‚  â”‚   ì›     â”‚  â”‚   ì›     â”‚  â”‚          â”‚      â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚      â”‚
â”‚  â”‚ â†‘ 50,000 â”‚  â”‚ â†‘ 100,000â”‚  â”‚ â†‘ 15,000 â”‚  â”‚ â†‘ 1.2%   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’§ ìì‚° ë³€ë™ ë‚´ì—­ (Waterfall Chart)                             â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚        â”‚                                                 â”‚ â”‚
â”‚  â”‚ 1.5M   â”‚  â”Œâ”€â”€â”                           â”Œâ”€â”€â”           â”‚ â”‚
â”‚  â”‚        â”‚  â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”             â”‚  â”‚           â”‚ â”‚
â”‚  â”‚ 1.0M   â”‚  â”‚  â”‚       â”‚ +ì…ê¸ˆâ”‚             â”‚ê¸ˆì›”â”‚          â”‚ â”‚
â”‚  â”‚        â”‚  â”‚ì „ì›”â”‚â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”¬â”€â”€â”€â”    â”‚ìì‚°â”‚          â”‚ â”‚
â”‚  â”‚ 0.5M   â”‚  â”‚ìì‚°â”‚       â””â”€â”€â”€â”€â”€â”˜   â”‚ì†ìµâ”‚â”€â”€â”€â”€â”¤   â”‚          â”‚ â”‚
â”‚  â”‚        â”‚  â”‚  â”‚                   â””â”€â”€â”€â”˜    â”‚   â”‚          â”‚ â”‚
â”‚  â”‚   0    â””â”€â”€â”´â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚
â”‚  â”‚          [1.32M] [+100K]  [1.42M] [+50K]   [1.47M]      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“Š ì›”ë³„ ì§€í‘œ ë¹„êµ                                               â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ì›”       â”‚ ì´ìì‚°    â”‚ ì´ì›ê¸ˆ    â”‚ ì´ìˆ˜ìµ    â”‚ ìˆ˜ìµë¥     â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ 2025-12  â”‚ 1,469,982 â”‚ 1,400,000 â”‚  +69,982  â”‚  +5.0%   â”‚ â”‚
â”‚  â”‚ 2025-11  â”‚ 1,319,982 â”‚ 1,300,000 â”‚  +19,982  â”‚  +1.5%   â”‚ â”‚
â”‚  â”‚ 2025-10  â”‚      -    â”‚      -    â”‚      -    â”‚     -    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ˆ ìì‚° ì¶”ì´ (Line Chart) - 2ê°œì›” ì´ìƒ ë°ì´í„° í•„ìš”               â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1.5M â”‚                                         â—â”€â”€â”€â”€â”€â—   â”‚ â”‚
â”‚  â”‚      â”‚                                       â—            â”‚ â”‚
â”‚  â”‚ 1.0M â”‚                                     â—              â”‚ â”‚
â”‚  â”‚      â”‚                                   â—                â”‚ â”‚
â”‚  â”‚ 0.5M â”‚                                 â—                  â”‚ â”‚
â”‚  â”‚      â”‚                               â—                    â”‚ â”‚
â”‚  â”‚   0  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚
â”‚  â”‚          09ì›”  10ì›”  11ì›”  12ì›”  01ì›”  02ì›”  03ì›”         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3. ì»´í¬ë„ŒíŠ¸ ìƒì„¸ ì„¤ê³„

### 3.1 Metric Cards (4ê°œ)

**ì»´í¬ë„ŒíŠ¸**: `st.metric()`

```python
# ë°ì´í„° ë¡œë”©
current_month_data = get_monthly_summary(selected_month)
previous_month_data = get_monthly_summary(get_previous_month(selected_month))

# ì¦ê° ê³„ì‚°
delta_total_value = current_month_data['total_value'] - previous_month_data['total_value']
delta_total_invested = current_month_data['total_invested'] - previous_month_data['total_invested']
delta_total_profit = current_month_data['total_profit'] - previous_month_data['total_profit']
delta_return_rate = current_month_data['return_rate'] - previous_month_data['return_rate']

# UI ë Œë”ë§
col1, col2, col3, col4 = st.columns(4)

with col1:
    st.metric(
        label="ğŸ’° ì´ ìì‚°",
        value=f"{current_month_data['total_value']:,}ì›",
        delta=f"{delta_total_value:+,}ì›"
    )

with col2:
    st.metric(
        label="ğŸ’µ ì´ ì›ê¸ˆ",
        value=f"{current_month_data['total_invested']:,}ì›",
        delta=f"{delta_total_invested:+,}ì›"
    )

with col3:
    st.metric(
        label="ğŸ“ˆ ì´ ìˆ˜ìµ",
        value=f"{current_month_data['total_profit']:+,}ì›",
        delta=f"{delta_total_profit:+,}ì›"
    )

with col4:
    st.metric(
        label="ğŸ“Š ìˆ˜ìµë¥ ",
        value=f"{current_month_data['return_rate']:+.1f}%",
        delta=f"{delta_return_rate:+.1f}%"
    )
```

**ë°ì´í„° êµ¬ì¡°** (`monthly_summary`):
```python
{
    'total_value': 1469982,      # ì´ ìì‚° (í‰ê°€ì•¡)
    'total_invested': 1400000,   # ì´ ì›ê¸ˆ
    'total_profit': 69982,       # ì´ ìˆ˜ìµ (í‰ê°€ì•¡ - ì›ê¸ˆ)
    'return_rate': 5.0           # ìˆ˜ìµë¥  (%)
}
```

### 3.2 Waterfall Chart (ìì‚° ë³€ë™ ë‚´ì—­)

**ì»´í¬ë„ŒíŠ¸**: `plotly.graph_objects.Waterfall`

```python
import plotly.graph_objects as go

def create_waterfall_chart(selected_month: str):
    """
    [ì „ì›” ìì‚°] â†’ [ì¶”ê°€ ì…ê¸ˆ] â†’ [í‰ê°€ ì†ìµ] â†’ [ê¸ˆì›” ìì‚°]
    """
    # ë°ì´í„° ì¤€ë¹„
    prev_month = get_previous_month(selected_month)
    prev_data = get_monthly_summary(prev_month)
    curr_data = get_monthly_summary(selected_month)

    # ê³„ì‚°
    prev_value = prev_data['total_value']
    deposit = curr_data['total_invested'] - prev_data['total_invested']  # ì¶”ê°€ ì…ê¸ˆ
    profit = (curr_data['total_value'] - curr_data['total_invested']) - \
             (prev_data['total_value'] - prev_data['total_invested'])  # í‰ê°€ ì†ìµ ì¦ê°
    curr_value = curr_data['total_value']

    # Waterfall ì°¨íŠ¸
    fig = go.Figure(go.Waterfall(
        name="ìì‚° ë³€ë™",
        orientation="v",
        measure=["absolute", "relative", "relative", "total"],
        x=["ì „ì›” ìì‚°", "ì¶”ê°€ ì…ê¸ˆ", "í‰ê°€ ì†ìµ", "ê¸ˆì›” ìì‚°"],
        y=[prev_value, deposit, profit, curr_value],
        text=[
            f"{prev_value:,}ì›",
            f"{deposit:+,}ì›",
            f"{profit:+,}ì›",
            f"{curr_value:,}ì›"
        ],
        textposition="outside",
        connector={"line": {"color": "rgb(63, 63, 63)"}},
        increasing={"marker": {"color": "#27ae60"}},  # ì¦ê°€: ë…¹ìƒ‰
        decreasing={"marker": {"color": "#e74c3c"}},  # ê°ì†Œ: ë¹¨ê°„ìƒ‰
        totals={"marker": {"color": "#3498db"}}       # í•©ê³„: íŒŒë€ìƒ‰
    ))

    fig.update_layout(
        title="ğŸ’§ ìì‚° ë³€ë™ ë‚´ì—­",
        showlegend=False,
        height=400,
        xaxis_title="",
        yaxis_title="ê¸ˆì•¡ (ì›)",
        yaxis_tickformat=","
    )

    return fig

# ë Œë”ë§
st.subheader("ğŸ’§ ìì‚° ë³€ë™ ë‚´ì—­")
fig = create_waterfall_chart(selected_month)
st.plotly_chart(fig, use_container_width=True)
```

### 3.3 ì›”ë³„ ë¹„êµ í…Œì´ë¸”

**ì»´í¬ë„ŒíŠ¸**: `st.dataframe()`

```python
def get_month_comparison_table(selected_month: str, num_months: int = 3):
    """
    ìµœê·¼ Nê°œì›” ë°ì´í„°ë¥¼ í…Œì´ë¸”ë¡œ ë°˜í™˜
    """
    months = get_recent_months(num_months)

    data = []
    for month in months:
        summary = get_monthly_summary(month)
        data.append({
            'ì›”': month,
            'ì´ ìì‚°': f"{summary['total_value']:,}ì›",
            'ì´ ì›ê¸ˆ': f"{summary['total_invested']:,}ì›",
            'ì´ ìˆ˜ìµ': f"{summary['total_profit']:+,}ì›",
            'ìˆ˜ìµë¥ ': f"{summary['return_rate']:+.1f}%"
        })

    return pd.DataFrame(data)

# ë Œë”ë§
st.subheader("ğŸ“Š ì›”ë³„ ì§€í‘œ ë¹„êµ")
df = get_month_comparison_table(selected_month)
st.dataframe(df, use_container_width=True, hide_index=True)
```

### 3.4 ìì‚° ì¶”ì´ ì°¨íŠ¸ (ì„ íƒì‚¬í•­)

**ì»´í¬ë„ŒíŠ¸**: `plotly.graph_objects.Scatter`

```python
import plotly.graph_objects as go

def create_asset_trend_chart():
    """
    ì „ì²´ ì›”ë³„ ìì‚° ì¶”ì´ ë¼ì¸ ì°¨íŠ¸
    """
    # ëª¨ë“  ì›” ë°ì´í„° ì¡°íšŒ
    all_months = get_all_months()

    if len(all_months) < 2:
        st.info("ìì‚° ì¶”ì´ ì°¨íŠ¸ëŠ” 2ê°œì›” ì´ìƒ ë°ì´í„°ê°€ í•„ìš”í•©ë‹ˆë‹¤.")
        return None

    months = []
    values = []

    for month in all_months:
        summary = get_monthly_summary(month)
        months.append(month)
        values.append(summary['total_value'])

    fig = go.Figure()

    fig.add_trace(go.Scatter(
        x=months,
        y=values,
        mode='lines+markers',
        name='ì´ ìì‚°',
        line=dict(color='#3498db', width=3),
        marker=dict(size=10)
    ))

    fig.update_layout(
        title="ğŸ“ˆ ìì‚° ì¶”ì´",
        xaxis_title="ì›”",
        yaxis_title="ì´ ìì‚° (ì›)",
        yaxis_tickformat=",",
        height=400
    )

    return fig

# ë Œë”ë§
st.subheader("ğŸ“ˆ ìì‚° ì¶”ì´")
fig = create_asset_trend_chart()
if fig:
    st.plotly_chart(fig, use_container_width=True)
```

## 4. ë°ì´í„° ìš”êµ¬ì‚¬í•­

### 4.1 í•„ìš”í•œ í•¨ìˆ˜ (`data_loader.py`)

```python
@st.cache_data(ttl=3600)
def get_monthly_summary(year_month: str) -> dict:
    """
    ì›”ë³„ ìš”ì•½ ë°ì´í„° ë°˜í™˜

    Returns:
        {
            'total_value': int,      # ì´ ìì‚° (í‰ê°€ì•¡)
            'total_invested': int,   # ì´ ì›ê¸ˆ
            'total_profit': int,     # ì´ ìˆ˜ìµ
            'return_rate': float     # ìˆ˜ìµë¥  (%)
        }
    """
    pass

def get_previous_month(year_month: str) -> str:
    """
    ì´ì „ ë‹¬ year_month ë°˜í™˜ (ì˜ˆ: '2025-12' -> '2025-11')
    """
    pass

def get_recent_months(num_months: int) -> List[str]:
    """
    ìµœê·¼ Nê°œì›” ë¦¬ìŠ¤íŠ¸ ë°˜í™˜ (ë‚´ë¦¼ì°¨ìˆœ)
    """
    pass

def get_all_months() -> List[str]:
    """
    DBì— ìˆëŠ” ëª¨ë“  ì›” ë¦¬ìŠ¤íŠ¸ ë°˜í™˜ (ì˜¤ë¦„ì°¨ìˆœ)
    """
    pass
```

### 4.2 DB ì¿¼ë¦¬ ë¡œì§

```sql
-- ì›”ë³„ ì´ ìì‚° ê³„ì‚°
SELECT
    SUM(h.amount) as total_invested,
    SUM(ah.my_amount) as total_value
FROM holdings h
JOIN analyzed_holdings ah ON h.id = ah.holding_id
WHERE h.account_id IN (
    SELECT id FROM accounts WHERE month_id = (
        SELECT id FROM months WHERE year_month = '2025-12'
    )
);

-- ì´ ìˆ˜ìµ = ì´ ìì‚° - ì´ ì›ê¸ˆ
-- ìˆ˜ìµë¥  = (ì´ ìˆ˜ìµ / ì´ ì›ê¸ˆ) * 100
```

## 5. ì—ëŸ¬ ì²˜ë¦¬

### 5.1 ë°ì´í„° ë¶€ì¡± ì‹œ

```python
try:
    current_data = get_monthly_summary(selected_month)
except DataNotFoundError:
    st.error(f"âŒ {selected_month} ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.")
    st.stop()

previous_month = get_previous_month(selected_month)
try:
    previous_data = get_monthly_summary(previous_month)
except DataNotFoundError:
    st.warning(f"âš ï¸ ì „ì›”({previous_month}) ë°ì´í„°ê°€ ì—†ì–´ ë¹„êµê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.")
    # ì „ì›” ë¹„êµ ì—†ì´ í˜„ì¬ ì›”ë§Œ í‘œì‹œ
    previous_data = None
```

### 5.2 ì°¨íŠ¸ ë Œë”ë§ ì‹¤íŒ¨ ì‹œ

```python
try:
    fig = create_waterfall_chart(selected_month)
    st.plotly_chart(fig, use_container_width=True)
except Exception as e:
    st.error(f"ì°¨íŠ¸ ë Œë”ë§ ì‹¤íŒ¨: {e}")
    # í…Œì´ë¸” í˜•ì‹ìœ¼ë¡œ ëŒ€ì²´ í‘œì‹œ
    st.table(get_waterfall_data_as_table(selected_month))
```

## 6. ì™„ì„± ì½”ë“œ ìŠ¤ì¼€ì¹˜

```python
# streamlit_app/pages/monthly_comparison.py

import streamlit as st
import plotly.graph_objects as go
from streamlit_app.data_loader import (
    get_monthly_summary,
    get_previous_month,
    get_recent_months,
    get_all_months
)

def render(selected_month: str):
    """ì›”ë³„ íˆ¬ì ë¹„êµ í˜ì´ì§€ ë Œë”ë§"""

    st.header(f"ğŸ“… ì›”ë³„ íˆ¬ì ë¹„êµ - {selected_month}")

    # ë°ì´í„° ë¡œë”©
    with st.spinner("ë°ì´í„° ë¡œë”© ì¤‘..."):
        current_data = get_monthly_summary(selected_month)

        previous_month = get_previous_month(selected_month)
        try:
            previous_data = get_monthly_summary(previous_month)
        except:
            previous_data = None
            st.warning(f"âš ï¸ ì „ì›” ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.")

    # 1. Metric Cards
    col1, col2, col3, col4 = st.columns(4)

    delta_value = current_data['total_value'] - previous_data['total_value'] if previous_data else 0
    delta_invested = current_data['total_invested'] - previous_data['total_invested'] if previous_data else 0
    delta_profit = current_data['total_profit'] - previous_data['total_profit'] if previous_data else 0
    delta_rate = current_data['return_rate'] - previous_data['return_rate'] if previous_data else 0

    with col1:
        st.metric("ğŸ’° ì´ ìì‚°", f"{current_data['total_value']:,}ì›",
                  delta=f"{delta_value:+,}ì›" if previous_data else None)

    with col2:
        st.metric("ğŸ’µ ì´ ì›ê¸ˆ", f"{current_data['total_invested']:,}ì›",
                  delta=f"{delta_invested:+,}ì›" if previous_data else None)

    with col3:
        st.metric("ğŸ“ˆ ì´ ìˆ˜ìµ", f"{current_data['total_profit']:+,}ì›",
                  delta=f"{delta_profit:+,}ì›" if previous_data else None)

    with col4:
        st.metric("ğŸ“Š ìˆ˜ìµë¥ ", f"{current_data['return_rate']:+.1f}%",
                  delta=f"{delta_rate:+.1f}%" if previous_data else None)

    st.divider()

    # 2. Waterfall Chart
    if previous_data:
        st.subheader("ğŸ’§ ìì‚° ë³€ë™ ë‚´ì—­")
        fig = create_waterfall_chart(selected_month, previous_data, current_data)
        st.plotly_chart(fig, use_container_width=True)
        st.divider()

    # 3. ì›”ë³„ ë¹„êµ í…Œì´ë¸”
    st.subheader("ğŸ“Š ì›”ë³„ ì§€í‘œ ë¹„êµ")
    df = get_month_comparison_table(selected_month)
    st.dataframe(df, use_container_width=True, hide_index=True)

    st.divider()

    # 4. ìì‚° ì¶”ì´ ì°¨íŠ¸
    st.subheader("ğŸ“ˆ ìì‚° ì¶”ì´")
    fig = create_asset_trend_chart()
    if fig:
        st.plotly_chart(fig, use_container_width=True)
```
